<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Creating a Character Controller with C++ (Part One)" /><meta property="og:locale" content="en" /><meta name="description" content="Over the past month or so, as part of a larger group assignment, I used C++ and Unreal Engine in a real-world project for the first time. The group assignment was to create a networked dodgeball game, and my role was the character controller and networking." /><meta property="og:description" content="Over the past month or so, as part of a larger group assignment, I used C++ and Unreal Engine in a real-world project for the first time. The group assignment was to create a networked dodgeball game, and my role was the character controller and networking." /><link rel="canonical" href="https://brooke.fyi/posts/cpp-character-controller-1/" /><meta property="og:url" content="https://brooke.fyi/posts/cpp-character-controller-1/" /><meta property="og:site_name" content="Brooke Rhodes" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-04-12T00:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Creating a Character Controller with C++ (Part One)" /><meta name="twitter:site" content="@grilme99" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-04-12T00:00:00+01:00","datePublished":"2023-04-12T00:00:00+01:00","description":"Over the past month or so, as part of a larger group assignment, I used C++ and Unreal Engine in a real-world project for the first time. The group assignment was to create a networked dodgeball game, and my role was the character controller and networking.","headline":"Creating a Character Controller with C++ (Part One)","mainEntityOfPage":{"@type":"WebPage","@id":"https://brooke.fyi/posts/cpp-character-controller-1/"},"url":"https://brooke.fyi/posts/cpp-character-controller-1/"}</script><title>Creating a Character Controller with C++ (Part One) | Brooke Rhodes</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Brooke Rhodes"><meta name="application-name" content="Brooke Rhodes"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.21.0/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return 'mode'; } static get MODE_ATTR() { return 'data-mode'; } static get DARK_MODE() { return 'dark'; } static get LIGHT_MODE() { return 'light'; } static get ID() { return 'mode-toggle'; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener('change', () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia('(prefers-color-scheme: dark)'); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { document.documentElement.removeAttribute(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage( { direction: ModeToggle.ID, message: this.modeStatus }, '*' ); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.notify(); } /* flipMode() */ } /* ModeToggle */ const modeToggle = new ModeToggle(); </script><body><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"> <img src="/assets/img/avatar.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"> </a><div class="site-title"> <a href="/">Brooke Rhodes</a></div><div class="site-subtitle fst-italic">Software Engineer working on games, systems, and tools.</div></div><ul class="nav flex-column flex-grow-1 w-100 ps-0"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/grilme99" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/grilme99" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fab fa-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['brooke','gril.me'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container px-xxl-5"><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100" > <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Creating a Character Controller with C++ (Part One)</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </span> <span id="search-cancel">Cancel</span></div></div><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pe-xl-4"><div class="post px-1 px-md-2"><h1 data-toc-skip>Creating a Character Controller with C++ (Part One)</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1681254000" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Apr 12, 2023 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://brooke.sh">Brooke Rhodes</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="1882 words" > <em>10 min</em> read</span></div></div></div><div class="post-content"><p>Over the past month or so, as part of a larger group assignment, I used C++ and Unreal Engine in a real-world project for the first time. The group assignment was to create a networked dodgeball game, and my role was the character controller and networking.</p><p>Being a university assignment, this was the perfect opportunity to experiment with technology I had never used before. I have long been fascinated with the inner workings of character controllers in video games, and I used the opportunity this assignment presented to create my own character controller from scratch, using C++ and Unreal Engine.</p><h2 id="planning"><span class="me-2">Planning</span><a href="#planning" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Before implementing the character controller, all components must be planned as appropriate. This group project is relatively short-term, with much more to do than just the character controller. As such, there is no time to go back and redo things if we implement them wrong.</p><h3 id="character-movement"><span class="me-2">Character Movement</span><a href="#character-movement" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Our group planning process isn’t too relevant to this blog post, so I’ll summarize by saying we were targeting a Quake or Titanfall-like moveset. That is, very fast-paced movement; momentum is everything, wall running, wall jumping, vaulting, and sliding.</p><p>If we had a video to summarize the perfect character movement we were aiming to achieve, then this would be it:</p><iframe class="embed-video youtube lazyload" src="https://www.youtube.com/embed/JjoboXpP9EA" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><p>Whilst that character movement looks (and largely is) very complex and intricate, it can be broken down into distinct movement types that can all be implemented independently with much lower complexity. There are two movement types which are absolutely essential for a minimum viable product (MVP) of our dodgeball game:</p><ol><li><em>Grounded</em>: The most obvious type of movement. This movement type supports the player moving along the ground. The speed they are moving (walking v.s. sprinting) is largely irrelevant to the movement type; it’s all about traversing ground geometry.<li><em>Airborne</em>: The other most obvious movement type. This movement type supports the player moving when not in contact with any ground geometry.</ol><p>Supporting those two movement types is the absolute priority because the game cannot function without them. However, once our MVP is complete, we can start to explore the implementation of other types of movement:</p><ol><li><em>Sliding</em>: This move type allows the player to slide along the ground with little control over their direction once the slide starts. The slide enables the player to move with a speed boost at the expense of control. The character must already be grounded to initiate a slide.<li><em>Wall running</em>: This move type allows the player to move in one direction along a wall. The player will be automatically dismounted when their forward velocity is too low or they jump (in which case they will be pushed off the wall with some forward velocity). Wall runs can be chained by jumping from wall to wall in succession.<li><em>Vaulting</em>: This move type allows players to clear obstacles in front of them if they are low enough (such as window frames or small boxes). It’s crucial that vaults are fast and can be chained with other movement types to maintain momentum.</ol><p>We will unlikely implement all of these different movement types by the time this assignment has to be submitted, but we planned for them and left room for their implementation. There is a reasonable period between when all assignments are due and the Graduate Showcase, which is when I plan to polish up our group project ready to be showcased there.</p><h3 id="implementation"><span class="me-2">Implementation</span><a href="#implementation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Before implementing the character controller, I planned how I would actually go about doing so. A character controller can be a large and complex project, so I wanted to ensure I got this right.</p><p>This assignment was an opportunity for learning, so I knew I wanted to build the controller from scratch. Whilst making it out of the building blocks Unreal Engine provides would have been significantly faster, that would have provided less opportunity to learn how a character controller truly works under the hood. As such, I decided to implement the entire controller from scratch, using a bespoke physics routine based on the implementation within Quake III. The advantage of referencing Quake III is that the source code is available online, which I can use as a guide when necessary.</p><p>Additionally, I took learnings from a previous character controller that I had some limited contributions to called <a href="https://github.com/easy-games/chickynoid">Chickynoid</a>. Chickynoid is also based on Quake and is a server-authoritative character controller for Roblox. Chickynoid is based loosely on Quake and was also a great source of learning for this project.</p><h4 id="detecting-collisions"><span class="me-2">Detecting Collisions</span><a href="#detecting-collisions" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><em>Sweep testing</em> is the foundation of Quake III’s character controller and is how it detects collisions with world geometry. The principle behind a sweep test is that instead of checking for an intersection between an object and the environment at a single point in time (which can lead to tunnelling issues where an object moves so fast that it passes through another object between frames), the game checks for intersections over the interval of time that corresponds to a single frame of movement.</p><p>This is done by essentially “sweeping” the character’s shape (usually represented as a simplified geometric shape like a sphere or a box) along the path they would take during that frame and checking if this swept shape intersects with any of the environment geometry. If an intersection is detected, the game can then respond appropriately.</p><p><a href="/assets/img/post/sweep-example-light.png" class="popup img-link light w-75 shadow rounded-10 shimmer"><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1212 668'%3E%3C/svg%3E" data-src="/assets/img/post/sweep-example-light.png" alt="light mode only" width="1212" height="668" class="lazyload" data-proofer-ignore></a> <a href="/assets/img/post/sweep-example-dark.png" class="popup img-link dark w-75 shadow rounded-10 shimmer"><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1212 668'%3E%3C/svg%3E" data-src="/assets/img/post/sweep-example-dark.png" alt="dark mode only" width="1212" height="668" class="lazyload" data-proofer-ignore></a> <em>Demonstration of a sweep test, a simple example of moving a box throught the world until it hits a wall.</em></p><p>Thankfully, I don’t need to re-implement sweep tests myself because Unreal Engine already has an equivalent API built into the engine. As much as I’m using this as a learning opportunity, re-implementing an <em>entire</em> physics pipeline in such a short timeframe is too unrealistic. The <a href="https://docs.unrealengine.com/5.0/en-US/API/Runtime/Engine/Engine/UWorld/SweepSingleByChannel/"><code class="language-plaintext highlighter-rouge">SweepSingleByChannel</code></a> API is capable of sweeping a physics shape through the world and reporting any collisions it encounters.</p><h4 id="movement-types"><span class="me-2">Movement Types</span><a href="#movement-types" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>As already explored, the character controller can be broken down into a distinct set of movement types (from here on out, we’ll refer to these as “move types” or <code class="language-plaintext highlighter-rouge">MoveType</code> in C++).</p><p>We need a way to represent move types in C++ that allows us to create as many move types as required without coupling each move type to one another. I have a strong background in the <a href="https://rust-lang.org">Rust</a> programming language, and in Rust, this would be represented perfectly by using <a href="https://doc.rust-lang.org/book/ch10-02-traits.html">traits</a>, which allows you to define shared behaviour in a structured manner. Take this example:</p><div class="language-rust highlighter-rouge"><div class="code-header"> <span data-label-text="Rust"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
</pre><td class="rouge-code"><pre><span class="c1">// Both no-ops for the sake of example here.</span>
<span class="k">struct</span> <span class="n">Simulation</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">Command</span><span class="p">;</span>

<span class="k">trait</span> <span class="n">MoveType</span> <span class="p">{</span>
    <span class="k">fn</span> <span class="nf">name</span><span class="p">()</span> <span class="k">-&gt;</span> <span class="nb">String</span><span class="p">;</span>
    
    <span class="cd">/// Ticks this move type. Tick takes a mutable reference to the character</span>
    <span class="cd">/// simulation (i.e. it can change simulation state) and an immutable</span>
    <span class="cd">/// reference to the command that tick. A command contains the player's</span>
    <span class="cd">/// input and the delta time since the previous tick.</span>
    <span class="k">fn</span> <span class="nf">tick</span><span class="p">(</span><span class="o">&amp;</span><span class="k">self</span><span class="p">,</span> <span class="n">simulation</span><span class="p">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="n">Simulation</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">Command</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="p">();</span>
<span class="p">}</span>

<span class="k">struct</span> <span class="n">MoveTypeWalking</span><span class="p">;</span>

<span class="k">impl</span> <span class="n">MoveType</span> <span class="k">for</span> <span class="n">MoveTypeWalking</span> <span class="p">{</span>
    <span class="k">fn</span> <span class="nf">name</span><span class="p">()</span> <span class="k">-&gt;</span> <span class="nb">String</span> <span class="p">{</span>
        <span class="s">"MoveTypeWalking"</span><span class="nf">.into</span><span class="p">()</span>
    <span class="p">}</span>
    
    <span class="k">fn</span> <span class="nf">tick</span><span class="p">(</span><span class="o">&amp;</span><span class="k">self</span><span class="p">,</span> <span class="n">_simulation</span><span class="p">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="n">Simulation</span><span class="p">,</span> <span class="n">_command</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">Command</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Do walking simulation stuff</span>
        <span class="c1">// ...</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// For the sake of example, we also implemented `MoveType` for `MoveTypeFlying`.</span>
<span class="k">struct</span> <span class="n">MoveTypeFlying</span><span class="p">;</span>

<span class="cd">/// The tick method takes a reference to any move type, and also to a simulation</span>
<span class="cd">/// and command, the same as above.</span>
<span class="k">fn</span> <span class="n">tick</span><span class="o">&lt;</span><span class="n">T</span><span class="p">:</span> <span class="n">MoveType</span><span class="o">&gt;</span><span class="p">(</span>
    <span class="n">move_type</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">T</span><span class="p">,</span>
    <span class="n">simulation</span><span class="p">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="n">Simulation</span><span class="p">,</span>
    <span class="n">command</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">Command</span>
<span class="p">)</span> <span class="p">{</span>
    <span class="nd">println!</span><span class="p">(</span><span class="s">"Ticking simulation..."</span><span class="p">);</span>
    <span class="n">move_type</span><span class="nf">.tick</span><span class="p">(</span><span class="n">simulation</span><span class="p">,</span> <span class="n">command</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p>In this code example, we define a <code class="language-plaintext highlighter-rouge">MoveType</code> trait, which allows us to implement as many move types as desired and accept any unique implementation as an argument to the <code class="language-plaintext highlighter-rouge">tick</code> function.</p><p>This concept can also be expressed in C++ in two different ways. The first is by using <em>abstract base classes</em>. Abstract base classes in C++ allow for polymorphic behaviour, similar to how traits are used in Rust. However, there are some differences. In C++, abstract base classes can have data members (fields), while Rust traits cannot. On the other hand, Rust traits can have default method implementations, which C++ abstract base classes cannot. Here’s an example:</p><div class="language-c++ highlighter-rouge"><div class="code-header"> <span data-label-text="C++"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;string&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span>
<span class="c1">// Both no-ops for the sake of example here.</span>
<span class="k">struct</span> <span class="nc">Simulation</span> <span class="p">{};</span>
<span class="k">struct</span> <span class="nc">Command</span> <span class="p">{};</span>

<span class="k">class</span> <span class="nc">MoveType</span> <span class="p">{</span>
<span class="nl">public:</span>
    <span class="k">virtual</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">name</span><span class="p">()</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">virtual</span> <span class="kt">void</span> <span class="n">tick</span><span class="p">(</span><span class="n">Simulation</span><span class="o">&amp;</span> <span class="n">simulation</span><span class="p">,</span> <span class="k">const</span> <span class="n">Command</span><span class="o">&amp;</span> <span class="n">command</span><span class="p">)</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">class</span> <span class="nc">MoveTypeWalking</span> <span class="o">:</span> <span class="k">public</span> <span class="n">MoveType</span> <span class="p">{</span>
<span class="nl">public:</span>
    <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">name</span><span class="p">()</span> <span class="k">const</span> <span class="k">override</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s">"MoveTypeWalking"</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="kt">void</span> <span class="n">tick</span><span class="p">(</span><span class="n">Simulation</span><span class="o">&amp;</span> <span class="n">simulation</span><span class="p">,</span> <span class="k">const</span> <span class="n">Command</span><span class="o">&amp;</span> <span class="n">command</span><span class="p">)</span> <span class="k">const</span> <span class="k">override</span> <span class="p">{</span>
        <span class="c1">// Do walking simulation stuff</span>
        <span class="c1">// ...</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="k">class</span> <span class="nc">MoveTypeFlying</span> <span class="o">:</span> <span class="k">public</span> <span class="n">MoveType</span> <span class="p">{</span>
<span class="nl">public:</span>
    <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">name</span><span class="p">()</span> <span class="k">const</span> <span class="k">override</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s">"MoveTypeFlying"</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="kt">void</span> <span class="n">tick</span><span class="p">(</span><span class="n">Simulation</span><span class="o">&amp;</span> <span class="n">simulation</span><span class="p">,</span> <span class="k">const</span> <span class="n">Command</span><span class="o">&amp;</span> <span class="n">command</span><span class="p">)</span> <span class="k">const</span> <span class="k">override</span> <span class="p">{</span>
        <span class="c1">// Do flying simulation stuff</span>
        <span class="c1">// ...</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="c1">// The tick function takes a pointer to any move type, and also to a simulation</span>
<span class="c1">// and command, the same as above.</span>
<span class="kt">void</span> <span class="nf">tick</span><span class="p">(</span><span class="k">const</span> <span class="n">MoveType</span><span class="o">*</span> <span class="n">move_type</span><span class="p">,</span> <span class="n">Simulation</span><span class="o">&amp;</span> <span class="n">simulation</span><span class="p">,</span> <span class="k">const</span> <span class="n">Command</span><span class="o">&amp;</span> <span class="n">command</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Ticking simulation..."</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">move_type</span><span class="o">-&gt;</span><span class="n">tick</span><span class="p">(</span><span class="n">simulation</span><span class="p">,</span> <span class="n">command</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Starting with C++20, C++ introduced <em>concepts</em>, which are more similar to Rust traits. Concepts define a set of requirements (such as functions that must be implemented) that a type must satisfy. Here’s a simple example:</p><div class="language-c++ highlighter-rouge"><div class="code-header"> <span data-label-text="C++"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;string&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span>
<span class="c1">// Both no-ops for the sake of example here.</span>
<span class="k">struct</span> <span class="nc">Simulation</span> <span class="p">{};</span>
<span class="k">struct</span> <span class="nc">Command</span> <span class="p">{};</span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">&gt;</span>
<span class="k">concept</span> <span class="n">MoveType</span> <span class="o">=</span> <span class="k">requires</span><span class="p">(</span><span class="n">T</span> <span class="n">t</span><span class="p">,</span> <span class="n">Simulation</span><span class="o">&amp;</span> <span class="n">simulation</span><span class="p">,</span> <span class="k">const</span> <span class="n">Command</span><span class="o">&amp;</span> <span class="n">command</span><span class="p">)</span> <span class="p">{</span>
    <span class="p">{</span> <span class="n">T</span><span class="o">::</span><span class="n">name</span><span class="p">()</span> <span class="p">}</span> <span class="o">-&gt;</span> <span class="n">std</span><span class="o">::</span><span class="n">same_as</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span><span class="p">;</span>
    <span class="p">{</span> <span class="n">t</span><span class="p">.</span><span class="n">tick</span><span class="p">(</span><span class="n">simulation</span><span class="p">,</span> <span class="n">command</span><span class="p">)</span> <span class="p">}</span> <span class="o">-&gt;</span> <span class="n">std</span><span class="o">::</span><span class="n">same_as</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="nc">MoveTypeWalking</span> <span class="p">{</span>
    <span class="k">static</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">name</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s">"MoveTypeWalking"</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="kt">void</span> <span class="n">tick</span><span class="p">(</span><span class="n">Simulation</span><span class="o">&amp;</span> <span class="n">simulation</span><span class="p">,</span> <span class="k">const</span> <span class="n">Command</span><span class="o">&amp;</span> <span class="n">command</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
        <span class="c1">// Do walking simulation stuff</span>
        <span class="c1">// ...</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="nc">MoveTypeFlying</span> <span class="p">{</span>
    <span class="k">static</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">name</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s">"MoveTypeFlying"</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="kt">void</span> <span class="n">tick</span><span class="p">(</span><span class="n">Simulation</span><span class="o">&amp;</span> <span class="n">simulation</span><span class="p">,</span> <span class="k">const</span> <span class="n">Command</span><span class="o">&amp;</span> <span class="n">command</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
        <span class="c1">// Do flying simulation stuff</span>
        <span class="c1">// ...</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="k">template</span><span class="o">&lt;</span><span class="n">MoveType</span> <span class="n">T</span><span class="p">&gt;</span>
<span class="kt">void</span> <span class="nf">tick</span><span class="p">(</span><span class="n">T</span><span class="o">&amp;</span> <span class="n">move_type</span><span class="p">,</span> <span class="n">Simulation</span><span class="o">&amp;</span> <span class="n">simulation</span><span class="p">,</span> <span class="k">const</span> <span class="n">Command</span><span class="o">&amp;</span> <span class="n">command</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Ticking simulation..."</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">move_type</span><span class="p">.</span><span class="n">tick</span><span class="p">(</span><span class="n">simulation</span><span class="p">,</span> <span class="n">command</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p>For my implementation, I’ll be going with abstract base classes. I chose this option because C++ 20 still has patchy support in Unreal Engine, and it’s unclear if I can currently use C++ concepts with the compiler toolchains that UE supports. Additionally, abstract base classes have a better online knowledge base surrounding them, which will likely make solving issues related to them significantly more straightforward.</p><h2 id="conclusion"><span class="me-2">Conclusion</span><a href="#conclusion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This entry’s purpose was to outline the planning of my C++ character controller. In the next blog entry, I will cover how I implemented the controller in C++ and where I ultimately ended up with its implementation. I have a clear vision of how to implement this controller, and I have outlined the most important parts in this entry.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href='/categories/university/'>University</a>, <a href='/categories/devblog/'>Devblog</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/university/" class="post-tag no-text-decoration" >university</a> <a href="/tags/c/" class="post-tag no-text-decoration" >c++</a> <a href="/tags/unreal-engine/" class="post-tag no-text-decoration" >unreal engine</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted me-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Creating%20a%20Character%20Controller%20with%20C++%20(Part%20One)%20-%20Brooke%20Rhodes&url=https%3A%2F%2Fbrooke.fyi%2Fposts%2Fcpp-character-controller-1%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter" > <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Creating%20a%20Character%20Controller%20with%20C++%20(Part%20One)%20-%20Brooke%20Rhodes&u=https%3A%2F%2Fbrooke.fyi%2Fposts%2Fcpp-character-controller-1%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook" > <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fbrooke.fyi%2Fposts%2Fcpp-character-controller-1%2F&text=Creating%20a%20Character%20Controller%20with%20C++%20(Part%20One)%20-%20Brooke%20Rhodes" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram" > <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content ps-0 pb-1 ms-1 mt-2"><li> <a href="/posts/one-button-jam-1/">Rust and Bevy Engine: One-Button GameJam (Part One)</a><li> <a href="/posts/one-button-jam-2/">Rust and Bevy Engine: One-Button GameJam (Part Two)</a><li> <a href="/posts/one-button-jam-3/">Rust and Bevy Engine: One-Button GameJam (Part Three)</a><li> <a href="/posts/unity-springs/">Springs for Animation in Unity</a><li> <a href="/posts/playfab-sdk-v3/">PlayFab SDK V3</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/university/">university</a> <a class="post-tag btn btn-outline-primary" href="/tags/gamejam/">gamejam</a> <a class="post-tag btn btn-outline-primary" href="/tags/rust/">rust</a> <a class="post-tag btn btn-outline-primary" href="/tags/c/">c++</a> <a class="post-tag btn btn-outline-primary" href="/tags/unreal-engine/">unreal engine</a> <a class="post-tag btn btn-outline-primary" href="/tags/c/">c#</a> <a class="post-tag btn btn-outline-primary" href="/tags/devlog/">devlog</a> <a class="post-tag btn btn-outline-primary" href="/tags/library/">library</a> <a class="post-tag btn btn-outline-primary" href="/tags/luau/">luau</a> <a class="post-tag btn btn-outline-primary" href="/tags/roblox/">roblox</a></div></div></div><div id="toc-wrapper" class="ps-0 pe-4 mb-5"><div class="panel-heading ps-3 pt-2 mb-2">Contents</div><nav id="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-3 pe-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ms-1" data-toc-skip> Further Reading</h3><div class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><div class="col"> <a href="/posts/cpp-character-controller-2/" class="card post-preview h-100"><div class="card-body"> <em class="small" data-ts="1681772400" data-df="ll" > Apr 18, 2023 </em><h4 class="pt-0 my-2" data-toc-skip>Creating a Character Controller with C++ (Part Two)</h4><div class="text-muted small"><p> After planning the character controller, it was time to implement it. The implementation so far has been very involved, so I will only cover the high-level points required to get to a minimally via...</p></div></div></a></div><div class="col"> <a href="/posts/one-button-jam-1/" class="card post-preview h-100"><div class="card-body"> <em class="small" data-ts="1674172800" data-df="ll" > Jan 20, 2023 </em><h4 class="pt-0 my-2" data-toc-skip>Rust and Bevy Engine: One-Button GameJam (Part One)</h4><div class="text-muted small"><p> A few months ago, I completed my first university game jam. Everybody was in teams of two to three, and the only rule was that the game could only use one button. Simple enough! While there was on...</p></div></div></a></div><div class="col"> <a href="/posts/one-button-jam-2/" class="card post-preview h-100"><div class="card-body"> <em class="small" data-ts="1674691200" data-df="ll" > Jan 26, 2023 </em><h4 class="pt-0 my-2" data-toc-skip>Rust and Bevy Engine: One-Button GameJam (Part Two)</h4><div class="text-muted small"><p> Given that we only had two weeks to complete this game jam, our group’s concept had to be simple to execute. After exploring various ideas, we ultimately chose a minigolf-style game that used only ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/unity-springs/" class="btn btn-outline-primary" prompt="Older" ><p>Springs for Animation in Unity</p></a> <a href="/posts/cpp-character-controller-2/" class="btn btn-outline-primary" prompt="Newer" ><p>Creating a Character Controller with C++ (Part Two)</p></a></div><script type="text/javascript"> (function () { const origin = 'https://giscus.app'; const iframe = 'iframe.giscus-frame'; const lightTheme = 'light'; const darkTheme = 'dark_dimmed'; let initTheme = lightTheme; const html = document.documentElement; if ( (html.hasAttribute('data-mode') && html.getAttribute('data-mode') === 'dark') || (!html.hasAttribute('data-mode') && window.matchMedia('(prefers-color-scheme: dark)').matches) ) { initTheme = darkTheme; } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'grilme99/grilme99.github.io', 'data-repo-id': 'R_kgDOHdYWRg', 'data-category': 'General', 'data-category-id': 'DIC_kwDOHdYWRs4CR34D', 'data-mapping': 'pathname', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'top', 'data-lang': 'en', crossorigin: 'anonymous', async: '' }; let giscusScript = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value) ); document.getElementById('tail-wrapper').appendChild(giscusScript); addEventListener('message', (event) => { if ( event.source === window && event.data && event.data.direction === ModeToggle.ID ) { /* global theme mode changed */ const mode = event.data.message; const theme = mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme; const message = { setConfig: { theme: theme } }; const giscus = document.querySelector(iframe).contentWindow; giscus.postMessage({ giscus: message }, origin); } }); })(); </script></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/university/">university</a> <a class="post-tag btn btn-outline-primary" href="/tags/gamejam/">gamejam</a> <a class="post-tag btn btn-outline-primary" href="/tags/rust/">rust</a> <a class="post-tag btn btn-outline-primary" href="/tags/c/">c++</a> <a class="post-tag btn btn-outline-primary" href="/tags/unreal-engine/">unreal engine</a> <a class="post-tag btn btn-outline-primary" href="/tags/c/">c#</a> <a class="post-tag btn btn-outline-primary" href="/tags/devlog/">devlog</a> <a class="post-tag btn btn-outline-primary" href="/tags/library/">library</a> <a class="post-tag btn btn-outline-primary" href="/tags/luau/">luau</a> <a class="post-tag btn btn-outline-primary" href="/tags/roblox/">roblox</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div></div><footer><div class="container px-lg-4"><div class="d-flex justify-content-center align-items-center text-muted mx-md-3"><p>Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p><p>© 2023 <a href="https://brooke.sh">Brooke Rhodes</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.0/dist/jquery.min.js,npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.7/dayjs.min.js,npm/dayjs@1.11.7/locale/en.min.js,npm/dayjs@1.11.7/plugin/relativeTime.min.js,npm/dayjs@1.11.7/plugin/localizedFormat.min.js,npm/tocbot@4.21.0/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/unregister.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-X2BTMY1TLL"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-X2BTMY1TLL'); }); </script> <script> /* Note: dependent library will be loaded in `js-selector.html` */ SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="px-1 px-sm-2 px-lg-4 px-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
